---
title: 'Build and Secure an API in Python with FastAPI'
date: '2021-05-31'
lastmod: '2021-07-10'
tags: ['API', 'Python', 'FastAPI']
draft: false
summary: 'As Python grows in popularity, the variety of high-quality frameworks available to developers has blossomed. In addition to steadfast options like Django and Flask, there are many new options including FastAPI.'
images: ['/static/images/blog/07/01.png']
---

As [Python grows in popularity](https://www.zdnet.com/article/programming-language-popularity-python-overtakes-java-as-rust-reaches-top-20/), the variety of high-quality frameworks available to developers has blossomed. In addition to steadfast options like [Django](https://www.djangoproject.com/) and [Flask](https://flask.palletsprojects.com/en/1.1.x/), there are many new options including [FastAPI](https://fastapi.tiangolo.com/).

First released [in late 2018](https://github.com/tiangolo/fastapi/releases?after=0.2.0), FastAPI differentiates itself from other Python frameworks by offering a modern, fast, and succinct developer experience for building reliable [REST APIs](https://www.redhat.com/en/topics/api/what-is-a-rest-api). While one of the newer open-source Python frameworks available, FastAPI has quickly gained a following with over [33,000 stars on GitHub](https://github.com/tiangolo/fastapi/stargazers) and an active [community of maintainers](https://fastapi.tiangolo.com/fastapi-people/) working on the project.

## Introduction :

With a little introduction on how I create DogeAPI a Backend API to secure and maintain the connection based on FastApi & SQLAlchemy.

FastApi is built on a Python framework called Starlette which is a lightweight ASGI framework/toolkit, which is itself built on Uvicorn.

Ideal for building high-performance asyncio services with seriously impressive performance.

That why DogeAPI is here, an API with high performance built with FastAPI & SQLAlchemy, helps to improve connection with your Backend Side and stay relate using SQLite3 & a secure Schema Based on Python-Jose a JavaScript Object Signing and Encryption implementation in Python.

### I use

- fastapi: FastAPI is a modern, fast (high-performance), a web framework for building APIs with Python 3.6+ based on standard Python type hints.
- uvicorn: Uvicorn is a lightning-fast ASGI server implementation, using uvloop and HTTP tools.
- sqlalchemy: SQLAlchemy is the Python SQL toolkit and Object Relational Mapper that gives application developers the full power and flexibility of SQL.
- passlib: Passlib is a password hashing library for Python 2 & 3, which provides cross-platform implementations of over 30 password hashing algorithms, as well as a framework for managing existing password hashes.
- bcrypt: Good password hashing for your software and your servers.
- python-Jose: The JavaScript Object Signing and Encryption (JOSE) technologies - JSON Web Signature (JWS), JSON Web Encryption (JWE), JSON Web Key (JWK), and JSON Web Algorithms (JWA) - collectively can be used to encrypt and/or sign content using a variety of algorithms.
- python-multipart: streaming multipart parser for Python.

### Into Code

- If you want to set environment variables you need to check token.py and use :

```
openssl rand -hex 32
```

To get a string like this.

```
SECRET_KEY = "a4ee1c733a80a5ac8824ac21b90ee6ae0158aee6642880fb2675929f99b1a677"
ALGORITHM = "HS256"
ACCESS_TOKEN_EXPIRE_MINUTES = 30
```

I Use a simple Model to implement with Database & the default configuration.

This for the Blog Table

```python
class Blog(Base):
    __tablename__ = "blogs"
    id = Column(Integer, primary_key=True,index=True)
    title = Column(String)
    body = Column(String)
    user_id = Column(Integer, ForeignKey("users.id"))
    creator = relationship("User", back_populates="blogs")
```

This for The Users Table

```python
class User(Base):
    __tablename__ = "users"
    id = Column(Integer, primary_key=True,index=True)
    name = Column(String)
    email = Column(String)
    password = Column(String)
    blogs = relationship("Blog", back_populates="creator")
```

For the database I use SQLAlchemy.ORM to create a session.

```python
SessionLocal = sessionmaker(bind=engine, autocommit=False, autoflush=False)
Base = declarative_base()
```

- I create a Docker Version for the DogeAPI also:

```Docker
FROM tiangolo/uvicorn-gunicorn-fastapi:python3.8
COPY requirements.txt ./
RUN pip install -r requirements.txt
COPY / DogeAPI
```

## Reference

- [chrisjsimpson/fastapi](https://github.com/chrisjsimpson/fastapi)
- [Additional Responses in OpenAPI](https://fastapi.tiangolo.com/advanced/additional-responses/)
- [OAuth2 scopes](https://fastapi.tiangolo.com/advanced/security/oauth2-scopes/)
- [Main Class](http://andrew-d.github.io/python-multipart/api.html#main-class)
- [pyca/bcrypt](https://github.com/pyca/bcrypt/)
- [Walkthrough & Tutorials](https://passlib.readthedocs.io/en/stable/narr/index.html)
- [The SQLAlchemy Session - In Depth](https://youtu.be/PKAdehPHOMo)
- [Fire-Up Your Backend With FastApi Starlette And Uvicorn](https://ra-6446.medium.com/fire-up-your-backend-with-fastapi-starlette-and-uvicorn-2a1861101d75)
- [Build and Secure an API in Python with FastAPI](https://developer.okta.com/blog/2020/12/17/build-and-secure-an-api-in-python-with-fastapi)
